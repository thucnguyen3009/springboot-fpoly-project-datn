<!DOCTYPE html>
<html lang="en" xmlns="https://www.thymeleaf.org" th:replace="~{/admin/layout/layout::dynamic(~{::title},~{::main})}">

<head>
   <!-- basic -->
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <!-- mobile metas -->
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="viewport" content="initial-scale=1, maximum-scale=1">
   <!-- site metas -->
   <!-- Thay thế title tại đây -->
   <title>Quản lý đơn hàng | DTNsBike</title>

</head>

<body>
   <!-- Content  -->
   <main>
      <!-- custom form cdn -->
      <link rel="stylesheet" href="https://cdn.form.io/formiojs/formio.full.min.css">
      <script src="https://cdn.form.io/formiojs/formio.full.min.js"></script>
      <!-- custom form cdn -->
      <div class="container-fluid">
         <!-- Title -->
         <div class="row column_title">
            <div class="col-md-12">
               <div class="page_title">
                  <h2>Danh Sách Đơn Hàng</h2>
               </div>
            </div>
         </div>
         <!-- Content -->
         <div class="row">
            <div class="col-12 card pt-2 pb-2 border-0">
               <div class="card-body p-2 text-end">
                  <div class="row">
                     <!-- Button effect -->
                     <a href="#" class="btn btn-success btn-rounded mb-1 mr-1 p-2">
                        <i class="fa fa-file-excel-o"></i>
                        <strong class="mt-1 ms-1">Xuất Excel</strong>
                     </a>
                     <!-- Button effect -->
                     <!-- Button effect -->
                     <a href="#" class="btn btn-outline-danger btn-rounded mb-1 mr-1" hidden>
                        <i class="fa fa-file-pdf-o"></i>
                        <strong class="mt-1 ms-1">Xuất Pdf</strong>
                     </a>
                     <!-- Button effect -->
                  </div>
               </div>
            </div>
         </div>
         <!-- Thân -->
         <div class="row card mt-2 border border-0">
            <div class="full inner_elements">
               <div class="row">
                  <div class="col-md-12">
                     <div class="tab_style2">
                        <div class="tabbar padding_infor_info">
                           <nav>
                              <div class="nav nav-tabs" id="nav-tab1" role="tablist">
                                 <a class="nav-item nav-link" th:classappend="${listid=='all-list'?'active':''}"
                                    th:href="@{/admin/orders-list/all-list}">Tất Cả Đơn Hàng</a>
                                 <a class="nav-item nav-link" id="nav-contact-tab2"
                                    th:classappend="${listid=='waitconfirm-list'?'active':''}"
                                    th:href="@{/admin/orders-list/waitconfirm-list}">Chờ Xác Nhận</a>
                                 <a class="nav-item nav-link" th:classappend="${listid=='wait-list'?'active':''}"
                                    th:href="@{/admin/orders-list/wait-list}">Chờ Lấy Hàng</a>
                                 <a class="nav-item nav-link" id="nav-contact-tab2"
                                    th:href="@{/admin/orders-list/shipped-list}"
                                    th:classappend="${listid=='shipped-list'?'active':''}">Đang Giao Hàng</a>
                                 <a class="nav-item nav-link" id="nav-contact-tab3"
                                    th:classappend="${listid=='done-list'?'active':''}"
                                    th:href="@{/admin/orders-list/done-list}">Đã giao</a>
                                 <a class="nav-item nav-link" id="nav-contact-tab3" th:classappend="${listid=='received-list'?'active':''}" th:href="@{/admin/orders-list/received-list}">Đã nhận Hàng</a>
                                 <a class="nav-item nav-link" id="nav-contact-tab4"
                                    th:classappend="${listid=='cancel-list'?'active':''}"
                                    th:href="@{/admin/orders-list/cancel-list}">Đã Hủy</a>
                              </div>
                           </nav>
                           <div class="tab-content" id="nav-tabContent_2">
                              <div class="tab-pane fade show active" id="nav-home_s2" role="tabpanel"
                                 aria-labelledby="nav-home-tab">
                                 <!-- Tất cả đơn hàng item -->
                                 <div class="card-header row border-0" style="background-color: white;">
                                    <div class="col-md-2">
                                       <div class="input-group mb-3">
                                          <div class="input-group-prepend">
                                             <label class="input-group-text bg-light border-0"
                                                for="inputGroupSelect01">Hiển
                                                thị: </label>
                                          </div>
                                          <select class="custom-select" id="allOrder" th:name="size"
                                             onchange='nameAll()'>
                                             <option value="5" th:selected="${size==5}">5</option>
                                             <option value="10" th:selected="${size==10}">10</option>
                                             <option value="15" th:selected="${size==15}">15</option>
                                             <option value="20" th:selected="${size==20}">20</option>
                                          </select>
                                       </div>
                                    </div>
                                    <div class="col-md-10 mb-1">
                                       <input class="form-control" list="datalistOptions" id="exampleDataList"
                                          placeholder="Tìm kiếm...">
                                       <!-- <datalist id="datalistOptions">
                                          <option value="Xe đạp địa hình">
                                          <option value="Xe đạp lạ lùng">
                                       </datalist> -->
                                    </div>
                                    <!-- <div class="col-md-2">
                                       <select class="custom-select text-center" id="inputGroupSelect01">
                                          <option selected>---Sắp xếp theo---</option>
                                          <option value="1">Mã Đơn Hàng</option>
                                          <option value="2">Ngày Đặt</option>
                                          <option value="3">Trạng Thái</option>
                                       </select>
                                    </div>
                                    <div class="col-md-2">
                                       <select class="custom-select text-center" id="inputGroupSelect01">
                                          <option selected>---Thứ tự---</option>
                                          <option value="1">Tăng dần</option>
                                          <option value="2">Giảm dần</option>
                                       </select>
                                    </div> -->
                                 </div>
                                 <div class="table-responsive">
                                    <table class="table table-bordered align-middle">
                                       <thead>
                                          <tr class="text-center bg-success">
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   MÃ ĐƠN

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   TRẠNG THÁI

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   KHÁCH HÀNG

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   NGƯỜI NHẬN

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   ĐIỆN THOẠI

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   ĐỊA CHỈ

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   NGÀY TẠO

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   GIẢM GIÁ

                                                </a>
                                             </th>
                                             <th class="text-white">
                                                ACTION
                                             </th>
                                          </tr>
                                       </thead>

                                       <tfoot>
                                          <tr class="text-center bg-success">
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   MÃ ĐƠN

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   TRẠNG THÁI

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   KHÁCH HÀNG

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   NGƯỜI NHẬN

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   ĐIỆN THOẠI

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   ĐỊA CHỈ

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   NGÀY TẠO

                                                </a>
                                             </th>
                                             <th>
                                                <a href="#" style="text-decoration: none;" class="text-white">

                                                   GIẢM GIÁ

                                                </a>
                                             </th>
                                             <th class="text-white">
                                                ACTION
                                             </th>
                                          </tr>
                                       </tfoot>

                                       <tbody>

                                          <!-- Table item  -->
                                          <tr th:if="${!listOrders.isEmpty()}" class="h6 text-center"
                                             th:each="o1 : ${listOrders}">
                                             <td class="align-middle text-primary">
                                                #HD00[[${o1.id}]]
                                             </td>
                                             <td class="align-middle">
                                                <p>
                                                   <!-- Chờ lấy hàng -->
                                                   <strong class="text-primary" th:if="${o1.statusId.id.equals('clh')}">
                                                      <span class="online_animation bg-primary"></span>
                                                      [[${o1.statusId.name}]]
                                                   </strong>
                                                   <!-- Đang giao -->
                                                   <strong class="text-secondary"
                                                      th:if="${o1.statusId.id.equals('dangi')}">
                                                      <span class="online_animation bg-secondary"></span>
                                                      [[${o1.statusId.name}]]
                                                   </strong>
                                                   <!-- Chờ xác nhận -->
                                                   <strong class="text-warning" th:if="${o1.statusId.id.equals('cxn')}">
                                                      <span class="online_animation bg-warning"></span>
                                                      [[${o1.statusId.name}]]
                                                   </strong>
                                                   <!-- Đã hủy -->
                                                   <strong class="text-danger" th:if="${o1.statusId.id.equals('dh')}">
                                                      <span class="online_animation bg-danger"></span>
                                                      [[${o1.statusId.name}]]
                                                   </strong>
                                                   <!-- Đã giao hàng -->
                                                   <strong class="text-success"
                                                      th:if="${o1.statusId.id.equals('dagi')}">
                                                      <span class="online_animation bg-success"></span>
                                                      [[${o1.statusId.name}]]
                                                   </strong>
                                                   <!-- Đã nhận hàng -->
                                                   <strong class="text-success" th:if="${o1.statusId.id.equals('dnh')}">
                                                      <span class="online_animation bg-success"></span>
                                                      [[${o1.statusId.name}]]
                                                   </strong>
                                                </p>
                                             </td>
                                             <td class="align-middle">
                                                <img width="30px" height="30px"
                                                   th:src="@{|/upload/accounts_img/${o1.userOrder.photo!=null?o1.userOrder.photo:'default.jpg'}|}"
                                                   alt="" class="border border-success rounded-circle img-fluid">
                                                [[${o1.userOrder.username}]]
                                             </td>
                                             <td class="align-middle">
                                                [[${o1.fullname}]]
                                             </td>
                                             <td class="align-middle">
                                                [[${o1.phone}]]
                                             </td>
                                             <td class="align-middle text-left text-wrap" style="width: 150px;">
                                                [[${o1.address}]]
                                             </td>
                                             <td class="align-middle">
                                                [[${#dates.format(o1.date,'dd-MM-yyyy')}]]
                                             </td>
                                             <td class="align-middle">
                                                [[${o1.saleId != null?o1.saleId.value+'%':'Không có'}]]
                                             </td>
                                             <td class="align-middle">
                                                <a class="btn btn-dark" href="#" data-toggle="modal"
                                                   th:attr="data-target='#exampleModal'+${o1.id}">
                                                   <i class="fa fa-eye"></i>
                                                </a>

                                                <a th:if="${o1.statusId.id.equals('cxn')}" class="btn btn-primary"
                                                   data-toggle="modal" th:attr="data-target='#modalUpdate'+${o1.id}">
                                                   <i class="fa fa-shopping-cart text-white"></i>
                                                </a>
                                                <a th:if="${o1.statusId.id.equals('clh') || o1.statusId.id.equals('dangi') }"
                                                   class="btn btn-primary"
                                                   th:attr="onclick=|update2('${o1.id}','${o1.statusId.id.equals('clh')?'giao hàng':'đã giao hàng'}','${o1.statusId.id.equals('clh')?'text-danger':'text-success'}')|">
                                                   <i class="fa fa-shopping-cart text-white"></i>
                                                </a>

                                                <a th:if="${o1.statusId.id.equals('cxn')}" href="#" data-toggle="modal"
                                                   th:attr="data-target='#modalCancel'+${o1.id}" class="btn btn-danger">
                                                   <i class="fa fa-ban" aria-hidden="true"></i>
                                                </a>


                                                <!-- Modal Cancel -->
                                                <div class="modal fade" th:attr="id='modalCancel'+${o1.id}"
                                                   tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                                                   aria-hidden="true">
                                                   <div class="modal-dialog text-left">
                                                      <div class="modal-content pb-3">
                                                         <div class="modal-header bg-danger">
                                                            <h5 class="modal-title text-white" id="exampleModalLabel">
                                                               THÔNG BÁO - ĐƠN HÀNG <u>HD00[[${o1.id}]]</u>
                                                            </h5>
                                                            <button type="button" class="close" data-dismiss="modal"
                                                               aria-label="Close">
                                                               <span aria-hidden="true">&times;</span>
                                                            </button>
                                                         </div>
                                                         <form method="POST"
                                                            th:attr="id='formHuy'+${o1.id},action='/DTNsBike/admin/orders-update/cancel/'+${o1.id}">
                                                            <div class="modal-body">

                                                               <div class="form-group">
                                                                  <label for="recipient-name"
                                                                     class="col-form-label h6 text-uppercase text-danger">Email
                                                                     khách hàng
                                                                     :</label>
                                                                  <input th:value="${o1.userOrder.email}" type="text"
                                                                     name="email" class="form-control"
                                                                     id="recipient-name"
                                                                     placeholder="Nhập email khách hàng..." disabled>
                                                               </div>
                                                               <div class="form-group">
                                                                  <label for="message-text"
                                                                     class="col-form-label h6 text-uppercase text-danger">Nội
                                                                     dung (LÝ DO HỦY ĐƠN):</label>
                                                                  <textarea name="message" class="form-control"
                                                                     th:attr="id='message-text'+${o1.id}" required
                                                                     style="height: 200px;"
                                                                     placeholder="Nhập nội dung ...."></textarea>
                                                               </div>

                                                            </div>
                                                            <div class="modal-footer">
                                                               <button type="button" class="btn btn-danger"
                                                                  th:attr="onclick=|cancelOrder('${o1.id}')|">
                                                                  Xác nhận
                                                               </button>
                                                               <button type="button" class="btn btn-info"
                                                                  data-dismiss="modal">
                                                                  Hủy bỏ
                                                               </button>
                                                            </div>
                                                         </form>
                                                      </div>
                                                   </div>
                                                </div>

                                                <!-- Modal Cancel -->

                                                <!-- Modal chi tiết đơn hàng -->
                                                <div class="modal fade" th:attr="id='exampleModal'+${o1.id}"
                                                   tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                   <div class="modal-dialog modal-lg">
                                                      <div class="modal-content p-3">
                                                         <div class="modal-header">
                                                            <h6 class="modal-title" style="font-size: 18px;"><i
                                                                  class="fa fa-file-text-o"></i> Chi tiết đơn hàng
                                                               HD00[[${o1.id}]]</h6>
                                                            <button type="button" class="close" data-dismiss="modal"
                                                               aria-label="Close">
                                                               <span aria-hidden="true">&times;</span>
                                                            </button>
                                                         </div>
                                                         <div class="modal-body row text-left">

                                                            <div class="col-md-6">
                                                               <div class="full invoice_blog">
                                                                  <h4>Thông tin khách hàng</h4>
                                                                  <p>
                                                                     <strong>Tên tài khoản:</strong>
                                                                     [[${o1.userOrder.username}]]<br>
                                                                     <strong>Họ tên người nhận : </strong>
                                                                     [[${o1.fullname}]]<br>
                                                                     <strong>Số điện thoại :
                                                                     </strong>[[${o1.phone}]]<br>
                                                                     <strong>Địa chỉ : </strong> [[${o1.address}]]<br>
                                                                  </p>
                                                               </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                               <div class="full invoice_blog">
                                                                  <h4>Thông tin đơn hàng </h4>
                                                                  <p>
                                                                     <strong>Mã đơn hàng : </strong>HD00[[${o1.id}]]<br>
                                                                     <strong>Ngày tạo đơn :
                                                                     </strong>[[${#dates.format(o1.date,'dd-MM-yyyy')}]]<br>
                                                                     <strong>Giảm giá:</strong> <span> [[${o1.saleId !=
                                                                        null?o1.saleId.value+'%':'Không có'}]] </span>
                                                                     <br>
                                                                     <strong>Tình trạng:</strong>
                                                                     <!-- Chờ lấy hàng -->
                                                                     <strong class="text-primary"
                                                                        th:if="${o1.statusId.id.equals('clh')}">
                                                                        <span
                                                                           class="online_animation bg-primary"></span>
                                                                        [[${o1.statusId.name}]]
                                                                     </strong>
                                                                     <!-- Đang giao -->
                                                                     <strong class="text-secondary"
                                                                        th:if="${o1.statusId.id.equals('dangi')}">
                                                                        <span
                                                                           class="online_animation bg-secondary"></span>
                                                                        [[${o1.statusId.name}]]
                                                                     </strong>
                                                                     <!-- Chờ xác nhận -->
                                                                     <strong class="text-warning"
                                                                        th:if="${o1.statusId.id.equals('cxn')}">
                                                                        <span
                                                                           class="online_animation bg-warning"></span>
                                                                        [[${o1.statusId.name}]]
                                                                     </strong>
                                                                     <!-- Đã hủy -->
                                                                     <strong class="text-danger"
                                                                        th:if="${o1.statusId.id.equals('dh')}">
                                                                        <span class="online_animation bg-danger"></span>
                                                                        [[${o1.statusId.name}]]
                                                                     </strong>
                                                                     <!-- Đã giao hàng -->
                                                                     <strong class="text-success"
                                                                        th:if="${o1.statusId.id.equals('dagi')}">
                                                                        <span
                                                                           class="online_animation bg-success"></span>
                                                                        [[${o1.statusId.name}]]
                                                                     </strong>
                                                                     <!-- Đã nhận hàng -->
                                                                     <strong class="text-success"
                                                                        th:if="${o1.statusId.id.equals('dnh')}">
                                                                        <span
                                                                           class="online_animation bg-success"></span>
                                                                        [[${o1.statusId.name}]]
                                                                     </strong><br>
                                                                     <strong>Trạng thái:</strong>
                                                                     <b th:classappend="${o1.statusId.id.equals('dagi')||o1.statusId.id.equals('dnh')?'text-success':'text-danger'}"
                                                                        class=""
                                                                        th:text="${!o1.statusId.id.equals('dagi') && !o1.statusId.id.equals('dnh')?'Chưa thanh toán':'Đã thanh toán'}"></b>
                                                                  </p>
                                                               </div>
                                                            </div>
                                                            <div class="col-md-12 mt-2">

                                                               <div class="table-responsive">
                                                                  <table class="table table-striped">
                                                                     <thead>
                                                                        <tr class="text-center">
                                                                           <!-- <th>Mã sản phẩm</th> -->
                                                                           <th>Tên sản phẩm</th>
                                                                           <th>Màu sắc</th>
                                                                           <th>Kích thước</th>
                                                                           <th>Số lượng </th>
                                                                           <th>Đơn giá</th>
                                                                           <th>Thành tiền</th>
                                                                        </tr>
                                                                     </thead>
                                                                     <tbody>
                                                                        <tr th:each="o11 : ${odd.findOne(o1.id)}"
                                                                           class="text-center">
                                                                           <!-- <td>SP[[${o11.productsId.productid.id}]]</td> -->
                                                                           <td class="align-middle">
                                                                              <!-- class="d-inline-block text-truncate" style="max-width: 150px;" -->
                                                                              <span class="text-left text-wrap"
                                                                                 style="max-width: 200px;">
                                                                                 [[${o11.productsId.productid.name}]]
                                                                                 <br>
                                                                                 <strong class="text-secondary"
                                                                                    th:if="${o11.warrantyPeriod!=null && o11.warrantyPeriod > 0}">
                                                                                    Bảo hành:
                                                                                    [[${o11.warrantyPeriod!=null &&
                                                                                    o11.warrantyPeriod >
                                                                                    0?o11.warrantyPeriod:''}]] ngày.

                                                                                    <span
                                                                                       th:if="${warran.findOrId(o11.id) != null}">
                                                                                       Mã bảo hành:
                                                                                       [[${warran.findOrId(o11.id).framenumber}]]
                                                                                       <br>
                                                                                    </span>
                                                                                 </strong>
                                                                              </span>
                                                                           </td>
                                                                           <td class="align-middle">
                                                                              [[${o11.productsId.colorid!=null?o11.productsId.colorid.name:'Không
                                                                              có'}]]
                                                                           </td>
                                                                           <td class="align-middle">
                                                                              [[${o11.productsId.sizeid!=null?o11.productsId.sizeid.id:'Không
                                                                              có'}]]
                                                                           </td>
                                                                           <td class="align-middle">
                                                                              [[${o11.amount}]]
                                                                           </td>
                                                                           <td class="align-middle">
                                                                              [[${#numbers.formatInteger((o11.price+(o11.price*o11.vat/100))-o11.price*(o11.discount/100),1,'COMMA')}]]
                                                                              VND
                                                                           </td>
                                                                           <td class="align-middle">
                                                                              [[${#numbers.formatInteger(((o11.price+(o11.price*o11.vat/100))-o11.price*(o11.discount/100))*o11.amount,1,'COMMA')}]]
                                                                              VND
                                                                           </td>

                                                                        </tr>
                                                                        <tr rowspan="6"
                                                                           th:each="o12 : ${odd.findOne(o1.id).get(0)}">
                                                                           <em class="text-success"
                                                                              th:if="${warran.findOrId(o12.id) != null}">
                                                                              Duyệt bởi:
                                                                              [[${warran.findOrId(o12.id).userWar.username}]]
                                                                           </em>
                                                                        </tr>
                                                                     </tbody>
                                                                  </table>
                                                               </div>

                                                            </div>

                                                         </div>

                                                         <div class="modal-footer">
                                                            <h6>TỔNG TIỀN:
                                                               <strong class="text-danger">
                                                                  [[${#numbers.formatInteger(odd.getSum(o1.id),1,'COMMA')}]]
                                                                  <!--  [[${#numbers.formatInteger(#aggregates.sum(odd.findOne(o1.id).![(price+(price*vat/100))*amount]),3,'COMMA')}]] -->
                                                                  VND
                                                               </strong>
                                                            </h6>
                                                         </div>
                                                      </div>
                                                   </div>
                                                </div>
                                                <!-- Model cập nhật đơn hàng -->
                                                <div class="modal fade" th:attr="id='modalUpdate'+${o1.id}"
                                                   tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                   <div class="modal-dialog modal-lg">
                                                      <div class="modal-content pb-3">
                                                         <div class="modal-header bg-primary">
                                                            <h6 class="modal-title text-uppercase text-white"
                                                               style="font-size: 18px;">
                                                               Cập nhật thông tin đơn
                                                               hàng
                                                               - HD00[[${o1.id}]]</h6>
                                                            <button type="button" class="close" data-dismiss="modal"
                                                               aria-label="Close">
                                                               <span aria-hidden="true">&times;</span>
                                                            </button>
                                                         </div>
                                                         <form th:action="@{|/admin/orders-update/${o1.id}|}"
                                                            method="post" th:attr="id='updateOrder'+${o1.id}">
                                                            <div class="modal-body row text-left">
                                                               <div class="col-md-12 mt-2">

                                                                  <div class="table-responsive">
                                                                     <table class="table table-striped">
                                                                        <thead>
                                                                           <tr class="text-center">
                                                                              <!-- <th>Mã sản phẩm</th> -->
                                                                              <th class="align-middle">Tên sản phẩm</th>
                                                                              <th class="align-middle">Màu sắc</th>
                                                                              <th class="align-middle">Kích thước</th>
                                                                              <th class="align-middle">Thời hạn bảo hành
                                                                                 (Theo ngày)
                                                                              </th>
                                                                              <th class="align-middle">Mã bảo hành (6 ký
                                                                                 tự)
                                                                              </th>
                                                                           </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                           <tr th:each="o11,stat : ${odd.findOne(o1.id)}"
                                                                              class="text-center">
                                                                              <!-- <td>SP[[${o11.productsId.productid.id}]]</td> -->
                                                                              <td class="align-middle">
                                                                                 <!-- class="d-inline-block text-truncate" style="max-width: 150px;" -->
                                                                                 <span class="text-left text-wrap"
                                                                                    style="max-width: 150px;">
                                                                                    [[${o11.productsId.productid.name}]]
                                                                                 </span>
                                                                              </td>
                                                                              <td class="align-middle">
                                                                                 [[${o11.productsId.colorid!=null?o11.productsId.colorid.name:'Không
                                                                                 có'}]]
                                                                              </td>
                                                                              <td class="align-middle">
                                                                                 [[${o11.productsId.sizeid!=null?o11.productsId.sizeid.name:'Không
                                                                                 có'}]]
                                                                              </td>
                                                                              <td class="align-middle">
                                                                                 <input type="number" min="0" max="365"
                                                                                    th:value="${o11.productsId.productid.warrantyperiod}"
                                                                                    th:attr="name=time+${stat.index},id=time+${stat.index}"
                                                                                    id="" class="form-control"
                                                                                    placeholder="Nhập bảo hành..."
                                                                                    required>
                                                                              </td>
                                                                              <td class="align-middle">
                                                                                 <input type="text" class="form-control"
                                                                                    th:attr="name=numberFrame+${stat.index},id=numberFrame+${stat.index}"
                                                                                    placeholder="Nhập mã bảo hành..."
                                                                                    required>
                                                                              </td>
                                                                           </tr>

                                                                        </tbody>
                                                                     </table>
                                                                  </div>

                                                               </div>

                                                            </div>

                                                            <div class="modal-footer">
                                                               <button class="btn btn-primary" type="button"
                                                                  th:attr="onclick=|update('${o1.id}')|">Cập nhật đơn
                                                                  hàng</button>
                                                               <button type="button" class="btn btn-secondary"
                                                                  data-dismiss="modal">
                                                                  Hủy bỏ
                                                               </button>
                                                            </div>
                                                         </form>

                                                      </div>
                                                   </div>
                                                </div>
                                             </td>
                                          </tr>
                                          <!-- Table item  -->
                                          <tr th:if="${listOrders.isEmpty()}" class="text-center">
                                             <td colspan="9" class="h6 align-middle">Không có dữ liệu...</td>
                                          </tr>
                                       </tbody>
                                    </table>

                                 </div>
                                 <!-- List content footer -->
                                 <div class="card-footer row mt-2 border-0" style="background-color: white;">
                                    <nav aria-label="..." class="col-4">
                                       <ul class="pagination">
                                          <li class="page-item" th:classappend ="${#numbers.formatInteger(page,0)} <= 1?'disabled':''">
                                            <a class="page-link" th:href="@{|/admin/orders-list/${listid}?page=1&&size=${size}|}" aria-label="Previous">
                                              <span aria-hidden="true">&laquo;</span>
                                            </a>
                                          </li>
                                          <li class="page-item disabled" th:if="${page == null}">
                                             <a class="page-link" th:href="@{|/admin/orders-list/${listid}(page=1,size=${size})|}">Back</a>
                                          </li>
                                          <li class="page-item" th:unless="${page == null}" th:classappend ="${#numbers.formatInteger(page,0)} <= 1?'disabled':''">
                                             <a th:if="${#numbers.formatInteger(page,0)} > 1" class="page-link" th:with="p=${#numbers.formatInteger(page,0)}-1" th:href="@{|/admin/orders-list/${listid}?page=${p}&&size=${size}|}">Back</a>
                                             <a th:unless="${#numbers.formatInteger(page,0)} > 1 " class="page-link" th:href="@{|/admin/orders-list/${listid}?page=1&&size=${size}|}">Back</a>
                                          </li>
                                          <th:block th:each="listPage:${listPage}">
                                             <li class="page-item" th:classappend="${#lists.contains(listPage, page)} ? active : ''">
                                                <a class="page-link"
                                                   th:href="@{|/admin/orders-list/${listid}?page=${listPage}&&size=${size}|}"
                                                   th:text="${listPage}"></a>
                                             </li>
                                          </th:block>
                                          <li class="page-item" th:if="${page == null}">
                                             <a class="page-link" th:href="@{|/admin/orders-list/${listid}?page=2&&size=${size}|}">Next</a>
                                          </li>
                                          <li class="page-item" th:unless="${page == null}" th:classappend ="${#numbers.formatInteger(page,0)} >= ${totalPage}?'disabled':''">
                                             <a th:if="${#numbers.formatInteger(page,0)} <= ${totalPage}" class="page-link" th:with="p=${#numbers.formatInteger(page,0)}+1" th:href="@{|/admin/orders-list/${listid}?page=${p}&&size=${size}|}">Next</a>
                                             <a th:unless="${#numbers.formatInteger(page,0)} <= ${totalPage}" class="page-link" th:href="@{|/admin/orders-list/${listid}?page=${#numbers.formatInteger(totalPage,0)}&&size=${size}|}">Next</a>
                                          </li>
                                          <li class="page-item" th:classappend ="${#numbers.formatInteger(page,0)} >= ${totalPage}?'disabled':''">
                                            <a class="page-link" th:href="@{|/admin/orders-list/${listid}?page=${totalPage}&&size=${size}|}" aria-label="Next">
                                              <span aria-hidden="true">&raquo;</span>
                                            </a>
                                          </li>
                                       </ul>
                                    </nav>
                                    <div class="col-2"></div>
                                    <div class="col-6 text-right text-dark">
                                       <p th:with="ttp=${#numbers.formatInteger(size,0)}+${pageableItems.getOffset()}">Đang xem [[${pageableItems.getOffset()}+1]] đến [[${ttp > totalItems}?${totalItems}:${#numbers.formatInteger(size,0)}+${pageableItems.getOffset()}]] trong tổng số [[${totalItems}]] mục.</p>
                                    </div>
                                 </div>
                                 <!-- List content footer end -->
                                 <!-- Tất cả đơn hàng item -->
                              </div>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>

         </div>
         <!-- thân end -->
      </div>
      <!-- Update order javascript -->
      <script th:inline="javascript">
         // update clh :))
         function update(id) {
            Swal.fire({
               position: 'top',
               title: 'Thông báo!',
               html: 'Duyệt đơn hàng <b class="text-primary"><u>HD00' + id + '</u></b> này!',
               icon: 'warning',
               showCancelButton: true,
               confirmButtonColor: '#3085d6',
               cancelButtonColor: '#d33',
               confirmButtonText: 'Đồng ý !',
               cancelButtonText: 'Hủy bỏ !'
            }).then((result) => {
               if (result.isConfirmed) {
                  document.getElementById('updateOrder' + id).submit();
               }
            })

         }

         function update2(id, mess, text) {
            Swal.fire({
               position: 'top',
               title: 'Thông báo!',
               html: 'Xác nhận <b class="' + text + '"><u>' + mess + '</u></b> cho đơn hàng <b class="text-primary"><u>HD00' + id + '</u></b> này!',
               icon: 'warning',
               showCancelButton: true,
               confirmButtonColor: '#3085d6',
               cancelButtonColor: '#d33',
               confirmButtonText: 'Đồng ý !',
               cancelButtonText: 'Hủy bỏ !'
            }).then((result) => {
               if (result.isConfirmed) {
                  document.getElementById('updateOrder' + id).submit();
               }
            })
         }

         var checks = /*[[${session.check}]]*/'';
         var checks2 = /*[[${session.checks}]]*/'';
         var checks3 = /*[[${session.checks2}]]*/'';
         var names = /*[[${session.name}]]*/'';
         if (checks == true && checks3 == undefined) {
            Swal.fire({
               position: 'top',
               title: 'Lỗi !',
               html: 'Thời hạn bảo hành và mã bảo hành của đơn hàng <b class="text-primary"><u> HD00' + names + '</u></b> không hợp lệ !',
               icon: 'error',
               timer: 15000
            }
            )
         }

         if (checks3 == true && checks == undefined) {
            Swal.fire({
               position: 'top',
               title: 'Lỗi !',
               html: 'Mã bảo hành của đơn hàng <b class="text-primary"><u> HD00' + names + '</u></b> đã tồn tại !',
               icon: 'error',
               timer: 15000
            }
            )
         }

         if (checks2 == true) {
            Swal.fire({
               position: 'top',
               title: 'Thông báo !',
               html: 'Cập nhật đơn hàng <b class="text-primary"><u> HD00' + names + '</u></b> thành công!',
               icon: 'success',
               timer: 15000
            }
            )
         }

      </script>
      <!-- Cancel order javascript -->
      <script th:inline="javascript">
         // Check delete
         function cancelOrder(id) {
            Swal.fire({
               position: 'top',
               title: 'Thông báo!',
               html: 'Xác nhận hủy đơn hàng  <b class="text-primary"><u>HD00' + id + '</u></b> này!',
               icon: 'warning',
               showCancelButton: true,
               confirmButtonColor: '#3085d6',
               cancelButtonColor: '#d33',
               confirmButtonText: 'Đồng ý !',
               cancelButtonText: 'Hủy bỏ !'
            }).then((result) => {
               if (result.isConfirmed) {
                  let chk = document.getElementById('message-text' + id).value;
                  if (chk == '' || chk == null || chk.length == 0) {
                     Swal.fire({
                        position: 'top',
                        title: 'Lỗi !',
                        text: 'Vui lòng nhập nội dung/lý do hủy đơn !',
                        icon: 'error'
                     })
                  } else {
                     let timerInterval
                     Swal.fire({
                        position: 'top',
                        title: 'Hủy đơn hàng!',
                        html: 'Đang xử lý vui lòng đợi .',
                        timer: 3250,
                        timerProgressBar: true,
                        didOpen: () => {
                           Swal.showLoading()
                           const b = Swal.getHtmlContainer().querySelector('b')
                           timerInterval = setInterval(() => {
                              b.textContent = Swal.getTimerLeft()
                           }, 100)
                        },
                        willClose: () => {
                           clearInterval(timerInterval)
                        }
                     }).then((result) => {
                        Swal.fire({
                           position: 'top',
                           title: 'Thông báo !',
                           text: 'Đã hủy đơn hàng thành công!',
                           icon: 'success',
                           showConfirmButton: false,
                           timer: 15000
                        }
                        )
                     })

                     chk = null;
                     document.getElementById('formHuy' + id).submit();
                     // window.location = "http://localhost:8080/DTNsBike/admin/orders-list/all-list";
                     // setTimeout(window.location.reload(), 300);
                  }
               }
            })
         }
      </script>
      <script>
         function nameAll() {
            var url_string = "http://localhost:8080/DTNsBike/admin/orders-list/[[${listid}]]?page=[[${page}]]&size=15";
            var url = new URL(url_string);
            var c = url.searchParams.get("page");
            var page = /*[[${page}]]*/null;
            var e = document.getElementById("allOrder");
            var sizes = e.value;
            var size = e.options[e.selectedIndex].text;
            var url = "/DTNsBike/admin/orders-list/[[${listid}]]?page=" + c + "&size=" + size;
            window.location = url;
         }
      </script>
   </main>
   <!-- Content  -->
</body>

</html>